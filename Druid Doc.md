# Druid官方文档翻译
## 入门
### 设计
#### Druid是什么？
Apache Druid（正在孵化中）是专为大型数据集上的高性能切片和切块分析（"OLAP"-类型）而设计的一个数据存储。Druid最常用作为GUI分析应用程序提供数据存储，或者用作需要快速聚合的高度并发API的后端。Druid的常见应用领域包括：

- 点击流分析
- 网络流量分析
- 服务器指标存储
- 应用性能指标
- 数字营销分析
- 商业智能/OLAP

Druid的主要特点是:
1. **列式存储格式**。Druid使用面向列的存储，意味着它只需要加载特定查询所需的列。这为仅查看几列的查询提供了巨大的速度提升。此外，每列都针对其特定数据类型进行了优化，支持快速扫描和聚合。
2. **可扩展的分布式系统**。Druid通常部署在数十到数百台服务器的集群中,并且可以提供数百万条记录/秒的摄取率，保留数万亿条记录，以及亚秒级到几秒钟的查询延迟。
3. **大规模并行处理**。Druid可以跨整个群集并行处理查询。
4. 实时或批量摄取。Druid可以实时摄取数据（摄取的数据可立即用于查询）或批量摄取。
5. **自愈，自平衡，易于操作**。作为操作员，要将群集扩展或缩小，只需添加或删除服务器，群集将在后台自动重新平衡，无需任何停机时间。如果任何Druid服务器发生故障，系统将自动绕过损坏路由，直到更换这些服务器。Druid旨在24*7全天候运行，无需任何原因计划停机，包括配置更改和软件更新。
6. **原生云支持，不会丢失数据的容错架构**。一旦Druid摄取了您的数据，副本就会安全地存储在深层存储中（通常是云存储，HDFS或共享文件系统）。即使每个Druid服务器都出现故障，您的数据也可以从深层存储中恢复。对于仅影响少数Druid服务器的有限的的故障，复制可确保在系统恢复时仍可进行查询。
7. **用于快速过滤的索引**。Druid使用CONCISE或Roaring压缩位图索引来创建索引，这些索引可以跨多个列进行快速过滤和搜索。
8. **近似算法**。Druid计算包括用于近似计数-去重，近似排序以及近似直方图和分位数的算法。这些算法使用有限的内存，并且通常比精确计算快得多。对于精度比速度更重要的情况，Druid还提供精确计数-去重且精确的排名。
9. **在摄取时自动汇总**。Druid可选择在摄取时支持数据汇总。汇总部分预聚合的数据，可以节省大量成本并提高性能。

#### 什么时候用Druid
如果您的情况符合以下几个描述，Druid可能是一个不错的选择：
* 插入率非常高，但更新不常见
* 您的大多数查询都是聚合和报告查询（"group by"查询）。您可能还有搜索和扫描查询。
* 您将查询延迟定位为100毫秒到几秒。
* 您的数据有一个时间组件（Druid包含与时间相关的优化设计）。
* 您可能有多个表，但每个查询只能访问一个大的分布式表。查询可能会遇到多个较小的“查找”表。
* 您有高基数数据列（例如网址，用户ID），需要对它们进行快速计数和排名。
* 您希望从Kafka，HDFS，平面文件（flat file）或对象存储（如Amazon S3）加载数据。
您可能不想使用Druid的情况包括：
* 您需要使用主键对现有记录进行低延迟更新。Druid支持流式插入，但不支持流式更新（使用后台批处理作业进行更新）。
* 您正在构建一个离线报告系统，其中查询延迟不是很重要。
* 你想做“大”join连接（将一个大表连接到另一个大表）。
#### 架构
Druid拥有一个多进程，分布式架构，旨在实现云友好且易于操作。每个Druid进程都可以独立配置和扩展，为您的群集提供最大的灵活性。此设计还提供增强的容错能力：一个组件的中断不会立即影响其他组件。
##### 进程和服务器
Druid有几种进程类型，简要描述如下：
- Coordinator进程管理群集上的数据可用性。
- Overlord进程控制数据提取工作负载的分配。
- Broker进程处理来自外部客户端的查询。
- Router进程是可选的进程，可以将请求路由转发到Broker，Coordinators和Overlords。
- Historical进程存储可查询数据。
- MiddleManager进程负责提取数据。
Druid进程可以按照您喜欢的方式进行部署，但为了便于部署，我们建议将它们组织为三种服务器类型：主服务器，查询和数据。
- Master：运行Coordinator和Overlord流程，管理数据可用性和摄取。
